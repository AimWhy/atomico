function getMethods(t){var e=[];do{e=e.concat(Object.getOwnPropertyNames(t))}while(t=Object.getPrototypeOf(t));return e}function getEvents(t){for(var e=/^on([A-Z])/,n=getMethods(t.prototype),r=[],o=0;o<n.length;o++){var s=n[o];n.indexOf(s)===o&&e.test(s)&&r.push({method:s,type:s.replace(e,function(t,e){return e.toLowerCase()})})}return r}function getProps(t,e){for(var n={},r=0;r<t.length;r++){var o=t[r],s=e instanceof HTMLElement?e.getAttribute(o):e[o];n[o.replace(/-+([\w])/g,function(t,e){return e.toUpperCase()})]=/^json-/.test(o)?JSON.parse(s):s}return n}function remove(t,e){t.removeChild(e)}function append(t,e){t.appendChild(e)}function replace(t,e,n){t.replaceChild(e,n)}function createText(){return document.createTextNode("")}function createElement(t,e){return e?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t)}function h(t,e){for(var n=[],r=arguments.length-2;r-- >0;)n[r]=arguments[r+2];return new VDom(t,e,concat(n))}function VDom(t,e,n){this.tag=t,this.props=e||{},this.children=n||[]}function isVDom(t){return"object"==typeof t&&t instanceof VDom}function concat(t,e){void 0===e&&(e=[]);for(var n=0;n<t.length;n++){var r=t[n];Array.isArray(r)?concat(r,e):e.push(isVDom(r)?r:new VDom("",{},r||""))}return e}function diffProps(t,e,n,r){for(var o=Object.keys(e).concat(Object.keys(n)),s=0;s<o.length;s++){var i=o[s];if(e[i]!==n[i])if("function"==typeof n[i]||"function"==typeof e[i])t[props.toLowerCase()]=n[i]||null;else if(i in n)if(i in t&&!r||r&&"style"===i)if("style"===i)if("object"==typeof n[i])for(var a in n[i])t.style[a]=n[i][a];else t.style.cssText=n[i];else t[i]=n[i];else r?t.setAttributeNS(null,i,n[i]):t.setAttribute(i,n[i]);else t.removeAttribute(i)}}function diff(t,e,n,r){for(var o=t.childNodes||[],s=Math.max(e.length,n.length),i=0;i<s;i++){var a=e[i]||new VDom,c=n[i],p=o[i];if(c){var u=p;if(r=r||"svg"===c.tag,a.tag!==c.tag)if(c.tag)if(u=createElement(c.tag,r),p)for(replace(t,u,p);p.firstChild;)u.appendChild(p.firstChild);else append(t,u);else u=createText(),a.tag?replace(t,u,p):append(t,u);"#text"===u.nodeName?a.children!==c.children&&(u.textContent=c.children):(diffProps(u,a.props,c.props,r),u&&diff(u,a.children,c.children,r))}else p&&remove(t,p)}}class Component{constructor(t){var e=this;this.root=t,this.props={},this.state={};var n=[];this.setState=function(t){void 0===t&&(t={}),e.state=Object.assign({},e.state,t);var r=concat([e.render()]);diff(e.root,n,r),n=r}}onMount(){}onUpdate(){}onUnmount(){}onRender(t){this.setState()}render(){}}function register(t,e){var n=e.props||[],r=getEvents(e);customElements.define(t,class extends HTMLElement{constructor(){super(),this.autorun(),this.root=new e(this)}static get observedAttributes(){return n}autorun(){var t=this;r.forEach(function(e){var n=e.type,r=e.method;t.addEventListener(n,function(e){t.root[r](e),e.defaultPrevented||("update"===n&&(t.root.props=Object.assign({},t.root.props,e.detail)),/^(render|unmount)$/.test(n)||t.dispatch("render"))},!0)})}connectedCallback(){this.dispatch("mount")}disconnectedCallback(){this.dispatch("unmount")}attributeChangedCallback(t,e,r){var o;this.dispatch("update",getProps(n,((o={})[t]=r,o)))}dispatch(t,e){this.dispatchEvent(new CustomEvent(t,{cancelable:!0,detail:e}))}})}export{h,Component,register};
//# sourceMappingURL=atomico.m.js.map
