function h(e,t){for(var r=[],n=arguments.length-2;n-- >0;)r[n]=arguments[n+2];return new VDom(e,t,concat(r))}function VDom(e,t,r){this.tag=e,this.props=t||{},this.children=r||[]}function isDom(e){return null!==e&&"object"==typeof e&&11!==e.nodeType}function isVDom(e){return"object"==typeof e&&e instanceof VDom}function concat(e,t){void 0===t&&(t=[]);for(var r=0;r<e.length;r++){var n=e[r];Array.isArray(n)?concat(n,t):t.push(isVDom(n)?n:isDom(n)?new VDom(n,{},""):new VDom("",{},n||""))}return t}var ELEMENT="__atomico_el__",MASTER="__atomico_prev__";function camelCase(e){return e.replace(/-+([\w])/g,function(e,t){return t.toUpperCase()})}function defer(e){return Promise.resolve().then(e)}function root(e){return e.shadowRoot||e}function remove(e,t){root(e).removeChild(t)}function append(e,t){root(e).appendChild(t)}function replace(e,t,r){root(e).replaceChild(t,r)}function diffProps(e,t,r,n,s){for(var o=Object.keys(t).concat(Object.keys(r)),i={},a=0;a<o.length;a++){var c=o[a];if(t[c]!==r[c]){if(s&&s.indexOf(c)>-1){i[c]=r[c];continue}if("function"==typeof r[c]||"function"==typeof t[c])t[c]&&e.removeEventListener(c,t[c]),e.addEventListener(c,r[c]);else if(c in r)if(c in e&&!n||n&&"style"===c)if("style"===c)if("object"==typeof r[c])for(var l in r[c])e.style[l]=r[c][l];else e.style.cssText=r[c];else e[c]=r[c];else{if(n&&"xmlns"===c)continue;n?e.setAttributeNS(null,c,r[c]):e.setAttribute(c,r[c])}else e.removeAttribute(c)}}return i}function slot(e,t){return"slot"===e.tag?new VDom(t[e.props.name]||"",e.props,e.children):e}function diff(e,t,r,n,s){void 0===n&&(n={});var o,i=t&&t[MASTER]?t[MASTER]:new VDom,a=t,c=r;if(r){if(r=slot(r,n),i=slot(i,n),s=s||"svg"===r.tag,o=isDom(r.tag),e&&i.tag!==r.tag)if(o)a=r.tag,t?replace(e,a,t):append(e,a);else if(r.tag)if(a=s?document.createElementNS("http://www.w3.org/2000/svg",r.tag):document.createElement(r.tag),t){if(replace(e,a,t),!a[ELEMENT])for(;t.firstChild;)append(a,t.firstChild)}else append(e,a);else a=document.createTextNode(""),i.tag?replace(e,a,t):append(e,a);if(3===a.nodeType)i.children!==r.children&&(a.textContent=r.children);else{var l=a[Element],p=diffProps(a,i.props,r.props,s,l&&a._props.keys);if(l)p.children=r.children.map(function(e){return e.tag?e:e.children}),this.setProperties(p);else if(a)for(var f=Array.from(a.childNodes),h=Math.max(f.length,r.children.length),u=0;u<h;u++)diff(a,f[u],r.children[u],n,s)}a[MASTER]=c}else e&&t&&remove(e,t);return e}class element extends HTMLElement{constructor(){super(),this[ELEMENT]=!0,this.slots={},this.props={},this.preventRender=!0,this.content=document.createDocumentFragment(),this.class=this.constructor,this._props={keys:this.class.observedAttributes,types:this.class.props}}static get props(){return{}}static get observedAttributes(){return Object.keys(this.props).concat("children")}get isMount(){return this[MASTER]}connectedCallback(){var e=this;defer(function(){for(var t=[];e.firstChild;){var r=e.firstChild,n=r.getAttribute&&r.getAttribute("slot");n&&(e.slots[n]=r),append(e.content,r),t.push(r)}e.setProperties({children:t}),e.preventRender=!1,e.setState({})})}setAttribute(e,t){var r;this._props.keys.indexOf(e)>-1?this.setProperties(((r={})[e]=t,r)):super.setAttribute(e,t)}setProperties(e){var t={},r=this.isMount;for(var n in e){var s,o=this._props.types[n],i=e[n];o&&(i=o(i)),s=camelCase(n),i!==this.props[s]&&(t[s]=i)}Object.keys(t).length&&(r&&(r=!1!==this.elementReceiveProps(t)),this.props=Object.assign({},this.props,t),r&&this.setState({}))}attributeChangedCallback(e,t,r){var n;this.setProperties(((n={})[e]=r,n))}disconnectedCallback(){this.elementMount()}setState(e){var t=this;"object"==typeof e&&(this.state=Object.assign({},this.state,e),this.preventRender||(this.preventRender=!0,defer(function(){var e=t.render(),r=t.isMount;e=isVDom(e)&&"host"===e.tag?e:h("host",null,e),diff(!1,t,e,t.slots),t.preventRender=!1,r?t.elementUpdate():t.elementMount()})))}elementMount(){}elementUnmount(){}elementUpdate(){}elementReceiveProps(){}render(){}}export{h,element as Element};
//# sourceMappingURL=atomico.m.js.map
